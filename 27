SELECT gt.good_type_name,
	SUM(p.amount * p.unit_price) AS costs
FROM Goods g
	JOIN GoodTypes gt ON g.type = gt.good_type_id
	JOIN Payments p ON g.good_id = p.good
WHERE YEAR(p.date) = 2005
GROUP BY gt.good_type_name
HAVING costs > 0;
